Categories:
  - Internet
License: Apache-2.0
AuthorName: New Vector Ltd.
AuthorEmail: press@element.io
WebSite: https://element.io/
SourceCode: https://github.com/vector-im/element-x-android
IssueTracker: https://github.com/vector-im/element-x-android/issues
Translation: https://localazy.com/p/element
Changelog: https://github.com/vector-im/element-x-android/blob/HEAD/CHANGES.md
Liberapay: matrixdotorg
Bitcoin: 1LxowEgsquZ3UPZ68wHf8v2MDZw82dVmAEa

AutoName: Element X

RepoType: git
Repo: https://github.com/vector-im/element-x-android.git

Builds:
  - versionName: 0.4.14
    versionCode: 40004141
    commit: v0.4.14
    subdir: app
    gradle:
      - fdroid
    srclibs:
      - reproducible-apk-tools@v0.2.7
    rm:
      - libraries/pushproviders/firebase
    prebuild:
      - sed -i -e '/gms/d' ../build.gradle.kts
      - sed -i -e '/isUniversalApk/s/true/false/' -e 's/include(.*)/include("armeabi-v7a")/'
        -e '/gplayImplementation/d' -e '/abiFilters/d' build.gradle.kts
      - echo -e "\nservices.maptiler.apikey=agdgS5zCgFZF5gDi9VXS" >> ../local.properties
      - echo -e "\nservices.maptiler.darkMapId=dea61faf-292b-4774-9660-58fcef89a7f3"
        >> ../local.properties
      - echo -e "\nservices.maptiler.lightMapId=9bc819c8-e627-474a-a348-ec144fe3d810"
        >> ../local.properties
      - sed -i -e 's/gitBranchName() = .*/gitBranchName() = "main"/' ../plugins/src/main/kotlin/extension/Utils.kt
    scandelete:
      - plugins
    postbuild: $$reproducible-apk-tools$$/inplace-fix.py --page-size 16 fix-pg-map-id
      $$OUT$$ '25590c9'

  - versionName: 0.4.14
    versionCode: 40004142
    commit: v0.4.14
    subdir: app
    gradle:
      - fdroid
    srclibs:
      - reproducible-apk-tools@v0.2.7
    rm:
      - libraries/pushproviders/firebase
    prebuild:
      - sed -i -e '/gms/d' ../build.gradle.kts
      - sed -i -e '/isUniversalApk/s/true/false/' -e 's/include(.*)/include("arm64-v8a")/'
        -e '/gplayImplementation/d' -e '/abiFilters/d' build.gradle.kts
      - echo -e "\nservices.maptiler.apikey=agdgS5zCgFZF5gDi9VXS" >> ../local.properties
      - echo -e "\nservices.maptiler.darkMapId=dea61faf-292b-4774-9660-58fcef89a7f3"
        >> ../local.properties
      - echo -e "\nservices.maptiler.lightMapId=9bc819c8-e627-474a-a348-ec144fe3d810"
        >> ../local.properties
      - sed -i -e 's/gitBranchName() = .*/gitBranchName() = "main"/' ../plugins/src/main/kotlin/extension/Utils.kt
    scandelete:
      - plugins
    postbuild: $$reproducible-apk-tools$$/inplace-fix.py --page-size 16 fix-pg-map-id
      $$OUT$$ '25590c9'

  - versionName: 0.4.14
    versionCode: 40004143
    commit: v0.4.14
    subdir: app
    gradle:
      - fdroid
    srclibs:
      - reproducible-apk-tools@v0.2.7
    rm:
      - libraries/pushproviders/firebase
    prebuild:
      - sed -i -e '/gms/d' ../build.gradle.kts
      - sed -i -e '/isUniversalApk/s/true/false/' -e 's/include(.*)/include("x86")/'
        -e '/gplayImplementation/d' -e '/abiFilters/d' build.gradle.kts
      - echo -e "\nservices.maptiler.apikey=agdgS5zCgFZF5gDi9VXS" >> ../local.properties
      - echo -e "\nservices.maptiler.darkMapId=dea61faf-292b-4774-9660-58fcef89a7f3"
        >> ../local.properties
      - echo -e "\nservices.maptiler.lightMapId=9bc819c8-e627-474a-a348-ec144fe3d810"
        >> ../local.properties
      - sed -i -e 's/gitBranchName() = .*/gitBranchName() = "main"/' ../plugins/src/main/kotlin/extension/Utils.kt
    scandelete:
      - plugins
    postbuild: $$reproducible-apk-tools$$/inplace-fix.py --page-size 16 fix-pg-map-id
      $$OUT$$ '25590c9'

  - versionName: 0.4.14
    versionCode: 40004144
    commit: v0.4.14
    subdir: app
    gradle:
      - fdroid
    srclibs:
      - reproducible-apk-tools@v0.2.7
    rm:
      - libraries/pushproviders/firebase
    prebuild:
      - sed -i -e '/gms/d' ../build.gradle.kts
      - sed -i -e '/isUniversalApk/s/true/false/' -e 's/include(.*)/include("x86_64")/'
        -e '/gplayImplementation/d' -e '/abiFilters/d' build.gradle.kts
      - echo -e "\nservices.maptiler.apikey=agdgS5zCgFZF5gDi9VXS" >> ../local.properties
      - echo -e "\nservices.maptiler.darkMapId=dea61faf-292b-4774-9660-58fcef89a7f3"
        >> ../local.properties
      - echo -e "\nservices.maptiler.lightMapId=9bc819c8-e627-474a-a348-ec144fe3d810"
        >> ../local.properties
      - sed -i -e 's/gitBranchName() = .*/gitBranchName() = "main"/' ../plugins/src/main/kotlin/extension/Utils.kt
    scandelete:
      - plugins
    postbuild: $$reproducible-apk-tools$$/inplace-fix.py --page-size 16 fix-pg-map-id
      $$OUT$$ '25590c9'

MaintainerNotes: Do not update unless requested by the Element team! The Element team
  will ping us whenever they feel a new release is ready. See https://github.com/vector-im/element-android/issues/3728
  as an example of their release process.

AutoUpdateMode: Version v%v
UpdateCheckMode: HTTP
VercodeOperation:
  - 1 + %c
  - 2 + %c
  - 3 + %c
  - 4 + %c
UpdateCheckData: https://api.github.com/repos/element-hq/element-x-android/releases/latest|"name"\
  *:\ *"(\d+)|.|"tag_name":"v(\d+\.\d+\.\d+)"
CurrentVersion: 0.4.14
CurrentVersionCode: 40004144
