AntiFeatures:
  - NonFreeNet
Categories:
  - Connectivity
  - Internet
  - Security
License: GPL-3.0-only
AuthorName: AmneziaVPN
AuthorEmail: support@amnezia.org
WebSite: https://amnezia.org/en
SourceCode: https://github.com/amnezia-vpn/amnezia-client
IssueTracker: https://github.com/amnezia-vpn/amnezia-client/issues
Changelog: https://github.com/amnezia-vpn/amnezia-client/releases
Donate: https://amnezia.org/en/about
Bitcoin: bc1qn9rhsffuxwnhcuuu4qzrwp4upkrq94xnh8r26u

AutoName: AmneziaVPN

RepoType: git
Repo: https://github.com/amnezia-vpn/amnezia-client.git

Builds:
  - versionName: 4.3.0.0
    versionCode: 43000
    commit: 4.3.0.0
    subdir: deploy
    submodules: true
    sudo:
      - apt-get update
      - apt-get install ninja-build libgl1-mesa-dev libstdc++6 libncurses5
      - apt-get install -y 7zip build-essential make python-is-python3
      - apt-get remove openjdk-11-jdk-headless openjdk-11-jre-headless
      - apt-get install openjdk-17-jdk-headless openjdk-17-jre-headless
      - apt-get install -y -t bookworm-backports cmake
    output: deploy/build
    srclibs:
      - Qt5@v6.6.2
    rm:
      - client/3rd-prebuilt/*
      - client/3rd/*
    prebuild:
      - sdkmanager 'platforms;android-34' 'build-tools;34.0.0'
      - cd $$Qt5$$
      - ./init-repository -f --module-subset=qtbase,qtdeclarative,qtimageformats,qtmultimedia,qtshadertools,qtsvg,qttools,qttranslations
    target: android-34
    build:
      - export ROOT_PATH=$(readlink -f ${PWD})
      - echo $ROOT_PATH
      - export JAVA_HOME=$(readlink -f /usr/bin/javac | sed "s:/bin/javac::")
      - export ANDROID_SDK_ROOT=$$SDK$$ ANDROID_NDK_ROOT=$$NDK$$
      - export ANDROID_API_VERSION=android-34
      - export PATH=${JAVA_HOME}/bin:${PATH}
      - export BUILD_DIR=$(readlink -f ${PWD})/android-build
      - export QT_HOST_BUILD=$$qt$$/build-host-qt
      - export QT_HOST_PATH=$$qt$$/v6.6.2/gcc_64
      - export QT_BUILD=$$qt$$/build-qt
      - export QTPREFIX=$$qt$$/v6.6.2
      - export ANDROID_BUILD_PLATFORM = android-34
      - rm -rf $QT_HOST_PATH $QT_HOST_BUILD $QTPREFIX $QT_BUILD
      - mkdir -p $BUILD_DIR $QT_HOST_PATH $QT_HOST_BUILD $QTPREFIX $QT_BUILD
      - pushd ${BUILD_DIR}
      - popd
      - pushd ${ROOT_PATH}
      - COMPILER=cross-android ./deploy/build_android.sh --debug --apk all --build-platform $ANDROID_BUILD_PLATFORM
        --move
      - popd
      - pushd ${QT_HOST_BUILD}
      - $$Qt5$$/configure -opensource -confirm-license -prefix $QT_HOST_PREFIX -release
        -submodules qtbase,qttools -nomake tests -nomake examples -no-sql-mysql -no-dbus
        -no-openssl -no-glib -no-icu -no-cups -no-fontconfig -no-gtk -no-egl 
        -skip qtsql,qtxml,qtprintsupport,qttestlib,qtwebengine,qtgamepad,qtwebchannel
        -skip qtwebview,qtwebsockets,qtwebglplugin,qtserialport,qtnetworkauth,qt3d,qtsensors
        -skip qtwayland,qtxmlpatterns,qtscxml,qtscript,qtconnectivity,qtimageformats
        -skip qtlanguageserver,qtquicktimeline,qtquick3d,qtactiveqt
        -skip qtcoap,qtdatavis3d,qthttpserver,qtpositioning,qtdoc,qtgrpc,qtlocation,qtlottie
        -skip qtmqtt,qtopcua,qtquick3dphysics,qtquickeffectmaker,qtremoteobjects,qtserialbus
        -skip qtspeech,qtvirtualkeyboard -no-opengl -no-feature-debug -no-feature-itemmodeltester
        -no-feature-concurrent -- -D CMAKE_INSTALL_MESSAGE=NEVER
      - cmake --build . --parallel
      - cmake --install .
      - popd
      - pushd ${QT_BUILD}
      - export $QT_HOST_PATH/qtbase/lib/cmake
      - $$Qt5$$/configure -platform android-clang --disable-rpath -opensource -confirm-license
        -silent -prefix $QTPREFIX -release -nomake tests -nomake examples -no-sql-mysql
        -no-dbus -no-use-gold-linker -sysconfdir /etc/xdg -opengl es2 -android-sdk
        $$SDK$$ -android-ndk $$NDK$$ -android-arch armeabi-v7a -android-ndk-platform
        android-34 -skip qtcoap,qtopcua,qtwebengine,qt3d,qtlanguageserver -skip qtdatavis3d,qtquick3d,qtwebview,qtactiveqt,qtquick3dphysics
        -skip qtserialport,qtquicktimeline,qtspeech,qtwebchannel -qt-host-path $QT_HOST_PATH
        -openssl-runtime -- -D OPENSSL_ROOT_DIR=$BUILD_DIR/buildroot/usr/local -D
        CMAKE_INSTALL_MESSAGE=NEVER
      - cmake --build . --parallel
      - cmake --install .
      - popd
      - pushd ${BUILD_DIR}
      - COMPILER=cross-android QTBINARYDIR=$QT_HOST_PATH/bin ../build_android.sh
        package
      - popd
    ndk: 26.1.10909125

  - versionName: 4.4.0.0
    versionCode: 44000
    commit: 4.4.0.0
    subdir: deploy
    submodules: true
    sudo:
      - apt-get update
      - apt-get install ninja-build libgl1-mesa-dev libstdc++6 libncurses5
      - apt-get install -y 7zip build-essential make python-is-python3
      - apt-get remove openjdk-11-jdk-headless openjdk-11-jre-headless
      - apt-get install openjdk-17-jdk-headless openjdk-17-jre-headless
      - apt-get install -y -t bookworm-backports cmake
    output: deploy/build
    srclibs:
      - Qt5@v6.6.2
    rm:
      - client/3rd-prebuilt/*
      - client/3rd/*
    prebuild:
      - sdkmanager 'platforms;android-34' 'build-tools;34.0.0'
      - cd $$Qt5$$
      - ./init-repository -f --module-subset=qtbase,qtdeclarative,qtimageformats,qtmultimedia,qtshadertools,qtsvg,qttools,qttranslations
    target: android-34
    build:
      - export ROOT_PATH=$(readlink -f ${PWD})
      - echo $ROOT_PATH
      - export JAVA_HOME=$(readlink -f /usr/bin/javac | sed "s:/bin/javac::")
      - export ANDROID_SDK_ROOT=$$SDK$$ ANDROID_NDK_ROOT=$$NDK$$
      - export ANDROID_API_VERSION=android-34
      - export PATH=${JAVA_HOME}/bin:${PATH}
      - export BUILD_DIR=$(readlink -f ${PWD})/android-build
      - export QT_HOST_BUILD=$$qt$$/build-host-qt
      - export QT_HOST_PATH=$$qt$$/v6.6.2/gcc_64
      - export QT_BUILD=$$qt$$/build-qt
      - export QTPREFIX=$$qt$$/v6.6.2
      - export ANDROID_BUILD_PLATFORM = android-34
      - rm -rf $QT_HOST_PATH $QT_HOST_BUILD $QTPREFIX $QT_BUILD
      - mkdir -p $BUILD_DIR $QT_HOST_PATH $QT_HOST_BUILD $QTPREFIX $QT_BUILD
      - pushd ${BUILD_DIR}
      - popd
      - pushd ${ROOT_PATH}
      - COMPILER=cross-android ./deploy/build_android.sh --debug --apk all --build-platform $ANDROID_BUILD_PLATFORM
        --move
      - popd
      - pushd ${QT_HOST_BUILD}
      - $$Qt5$$/configure -opensource -confirm-license -prefix $QT_HOST_PREFIX -release
        -submodules qtbase,qttools -nomake tests -nomake examples -no-sql-mysql -no-dbus
        -no-openssl -no-glib -no-icu -no-cups -no-fontconfig -no-gtk -no-egl 
        -skip qtsql,qtxml,qtprintsupport,qttestlib,qtwebengine,qtgamepad,qtwebchannel
        -skip qtwebview,qtwebsockets,qtwebglplugin,qtserialport,qtnetworkauth,qt3d,qtsensors
        -skip qtwayland,qtxmlpatterns,qtscxml,qtscript,qtconnectivity,qtimageformats
        -skip qtlanguageserver,qtquicktimeline,qtquick3d,qtactiveqt
        -skip qtcoap,qtdatavis3d,qthttpserver,qtpositioning,qtdoc,qtgrpc,qtlocation,qtlottie
        -skip qtmqtt,qtopcua,qtquick3dphysics,qtquickeffectmaker,qtremoteobjects,qtserialbus
        -skip qtspeech,qtvirtualkeyboard -no-opengl -no-feature-debug -no-feature-itemmodeltester
        -no-feature-concurrent -- -D CMAKE_INSTALL_MESSAGE=NEVER
      - cmake --build . --parallel
      - cmake --install .
      - popd
      - pushd ${QT_BUILD}
      - export $QT_HOST_PATH/qtbase/lib/cmake
      - $$Qt5$$/configure -platform android-clang --disable-rpath -opensource -confirm-license
        -silent -prefix $QTPREFIX -release -nomake tests -nomake examples -no-sql-mysql
        -no-dbus -no-use-gold-linker -sysconfdir /etc/xdg -opengl es2 -android-sdk
        $$SDK$$ -android-ndk $$NDK$$ -android-arch armeabi-v7a -android-ndk-platform
        android-34 -skip qtcoap,qtopcua,qtwebengine,qt3d,qtlanguageserver -skip qtdatavis3d,qtquick3d,qtwebview,qtactiveqt,qtquick3dphysics
        -skip qtserialport,qtquicktimeline,qtspeech,qtwebchannel -qt-host-path $QT_HOST_PATH
        -openssl-runtime -- -D OPENSSL_ROOT_DIR=$BUILD_DIR/buildroot/usr/local -D
        CMAKE_INSTALL_MESSAGE=NEVER
      - cmake --build . --parallel
      - cmake --install .
      - popd
      - pushd ${BUILD_DIR}
      - COMPILER=cross-android QTBINARYDIR=$QT_HOST_PATH/bin ../build_android.sh
        package
      - popd
    ndk: 26.1.10909125

AutoUpdateMode: Version
UpdateCheckMode: Tags
CurrentVersion: 4.4.0.0
CurrentVersionCode: 44000