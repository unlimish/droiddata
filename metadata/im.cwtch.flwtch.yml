Categories:
  - Internet
License: MIT
WebSite: https://cwtch.im
SourceCode: https://git.openprivacy.ca/cwtch.im/cwtch-ui
IssueTracker: https://git.openprivacy.ca/cwtch.im/cwtch-ui/issues
Changelog: https://cwtch.im/changelog/
Donate: https://openprivacy.ca/donate/

AutoName: Cwtch
Summary: Metadata resistant privacy platform designed to help you resist surveillance
Description: |-
    Cwtch (/kʊtʃ/ - a Welsh word roughly translating to “a hug that creates a safe place”) is a decentralized, privacy-preserving, multi-party messaging protocol that can be used to build metadata resistant applications.

    Decentralized and Open: There is no “Cwtch service” or “Cwtch network”. Participants in Cwtch can host their own safe spaces, or lend their infrastructure to others seeking a safe space. The Cwtch protocol is open, and anyone is free to build bots, services and user interfaces and integrate and interact with Cwtch.

    Privacy Preserving: All communication in Cwtch is end-to-end encrypted and takes place over Tor v3 onion services.

    Metadata Resistant: Cwtch has been designed such that no information is exchanged or available to anyone without their explicit consent, including on-the-wire messages and protocol metadata.

RepoType: git
Repo: https://git.openprivacy.ca/cwtch.im/cwtch-ui.git

Builds:
  - versionName: 1.9.0
    versionCode: 35
    commit: 2d89b30881ae81808c1c6c1b7d4d4a77def06390
    sudo:
      - apt-get update
      - apt-get install -y autoconf autogen automake autopoint autotools-dev build-essential
        gcc-arm-linux-gnueabihf libevent-dev libtool libssl-dev m4 pkg-config zlib1g-dev
    output: build/app/outputs/apk/release/app-release-unsigned.apk
    srclibs:
      - flutter@3.0.5
      - libcwtch-go@397d264bd9ff1cf0a83e62c5c079b3894c069250
      - tor-android@3fd6787249dc83e8a1d3403043ae4ded0641977c
    prebuild:
      - mkdir -p android/app/src/main/jniLibs/{arm64-v8a,armeabi-v7a,x86,x86_64}
      - sed -i -e '/InvalidPackage/aabortOnError false' android/app/build.gradle
      - sed -i -e 's/3.5.4/4.0.1/' android/build.gradle
      - echo `git describe --tags --abbrev=1` > VERSION
      - echo `date +%G-%m-%d-%H-%M` > BUILDDATE
      - cd $$tor-android$$
      - sed -i -e "/$1 = 'debug/,+4d" tor-droid-make.sh
      - sed -i -e '/dirauth/a--disable-tool-name-check --disable-asciidoc --disable-manpage
        --disable-html-manual \\' external/Makefile
      - ./tor-droid-make.sh fetch
    scandelete:
      - integration_test
    build:
      - pushd $$tor-android$$
      - ./tor-droid-make.sh build -b release
      - popd
      - cp $$tor-android$$/external/lib/arm64-v8a/libtor.so android/app/src/main/jniLibs/arm64-v8a/
      - cp $$tor-android$$/external/lib/x86_64/libtor.so android/app/src/main/jniLibs/x86_64/
      - cp $$tor-android$$/external/lib/armeabi-v7a/libtor.so android/app/src/main/jniLibs/armeabi-v7a/
      - cp $$tor-android$$/external/lib/x86/libtor.so android/app/src/main/jniLibs/x86/
      - pushd $$libcwtch-go$$
      - curl -Lso go.tar.gz https://golang.org/dl/go1.17.13.linux-amd64.tar.gz
      - echo "4cdd2bc664724dc7db94ad51b503512c5ae7220951cac568120f64f8e94399fc go.tar.gz"
        | sha256sum -c -
      - tar xzf go.tar.gz
      - export GOPATH="$PWD/golang"
      - export GOPROXY=direct
      - export PATH="$GOPATH/bin:$PWD/go/bin:$PATH"
      - export ANDROID_NDK_HOME=$$NDK$$
      - go mod download
      - go get -u golang.org/x/mobile@bdb1ca9a1e083af5929a8214e8a056d638ebbf2d
      - go get -u golang.org/x/mobile/cmd/gomobile
      - go get -u golang.org/x/mobile/cmd/gobind
      - go get -u golang.org/x/mobile/bind
      - ./switch-gomobile.sh
      - gomobile init
      - gomobile bind -target android -ldflags="-X cwtch.buildVer=$(git describe --tags)
        -X cwtch.buildDate=$(date +%G-%m-%d-%H-%M)"
      - popd
      - mv $$libcwtch-go$$/cwtch.aar android/cwtch/
      - $$flutter$$/bin/flutter config --no-analytics
      - $$flutter$$/bin/flutter packages pub get
      - $$flutter$$/bin/flutter build apk --dart-define BUILD_VER=`cat VERSION` --dart-define
        BUILD_DATE=`cat BUILDDATE`
    ndk: r21

AutoUpdateMode: Version
UpdateCheckMode: Tags
UpdateCheckData: pubspec.yaml|version:\s.*\+(\d+)|.|version:\s(.*)\+
CurrentVersion: 1.9.0
CurrentVersionCode: 35
